This code performs an end-to-end single-cell RNA-seq analysis combined with bulk deconvolution. It begins by loading and merging single-cell datasets (both training and test sets) along with several bulk datasets. After exploring and visualizing key quality metrics, it preprocesses the data by filtering, normalizing, identifying highly variable genes, correcting batch effects, and reducing dimensionality using PCA and UMAP. Next, it predicts missing cell type labels in the test set via a K-Nearest Neighbors classifier. The workflow then shifts to deconvolution where it computes a signature matrix based on mean expression per cell type and applies the Cellanneal package to estimate cell type proportions in bulk samples. Finally, it validates the predictions using RMSE, orders the results appropriately, and exports both the deconvolution results and clustering assignments into a zipped archive.
